# CVE-2023-2719

- Plugin : SupportCandy
- Phiên bản lỗi : < 3.1.7
- Lỗi : Subscriber+ SQL Injection
- CVSS Score: 8.8 (MEDIUM)

# Mô tả

Plugin không dọn dẹp và thoát tham số `id` đúng cách cho Tác nhân trong API REST trước khi sử dụng nó trong câu lệnh SQL, dẫn đến việc người dùng có vai trò thấp như Subscriber có thể khai thác SQL Injection .

# POC

- Thông số "id" dễ bị tấn công bởi SQL Injeciton.
  Ví dụ 1: wp-json/supportcandy/v2/agents/234563?id=-1 OR 1%3D(SELECT IF(1%3D1,SLEEP(5),1))
- Truy vấn này sẽ trì hoãn tải trang 5 giây

# Khai Thác

- Bắt request kiểm tra xem thời gian phản hồi của trang là bao lâu

- Ta để ý thời gian trả về lớn hơn 5 giây
- Sử dụng công cụ Sqlmap để thực hiện dump dữ liệu
  B1: Xác định lỗi là time-based blind sqli

B2: Dump bảng trong information_schema

B3: Dump cột trong bảng wp_users

B4: Dump giá trị các cột trong bảng wp_users
