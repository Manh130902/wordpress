# CVE-2023-2123

- Plugin : WP Inventory Manager
- Phiên bản lỗi : 2.1.0.12
- Lỗi : Reflexed Cross-Site Scripting (XSS)

# Mô tả

- Plugin này cung cấp chức năng quản lý sản phẩm, thiết bị, ... trong trang web WordPress của bạn. Thích hợp cho các đại lý xe hơi, nhà sưu tập nghệ thuật, đại lý phụ tùng,…
- Trong phiên bản 2.1.0.12 có chức năng quản lý hoàng tồn kho nhưng do Plugin không loại bỏ và thoát khỏi một tham số trước khi xuất nó trở lại trang nên kẻ tấn công có thể lợi dụng để chèn các đoạn script độc hại

# POC

- B1: Chuyển hướng đến trang có mặt hàng tồn kho
- B2: truy cập vào 1 sản phẩm mà bạn muốn
- B3: Điền vào biểu mẫu trong phần "Reserve This Item” của trang và nhấp vào nút "Reserve"
- B4: Khi bạn đã được chuyển hướng đến trang "Your reservation has been submited", hãy thêm payload ENCODED "%3Cscript%3Ealert%281%29%3C%2Fscript%3E" vào tham số message trong URL;

Khi bạn thực hiện tất cả các bước và cập nhật trang hiện tại, nó sẽ bật lên cảnh báo kèm theo thông báo trong mà bạn đa chứa trong payload

# Khai thác

- B1: Chuyển hướng đến trang có mặt hàng tồn kho
  ![image](https://github.com/Manh130902/wordpress/assets/93723285/ab2809ad-e1b9-4136-89a7-a548ec083d27)

- B2: Truy cập vào 1 sản phẩm mà bạn muốn
  ![image](https://github.com/Manh130902/wordpress/assets/93723285/8ac1aca6-2bbd-46f3-be20-d264d4acd434)

- B3: Điền vào biểu mẫu trong phần "Reserve This Item” của trang và nhấp vào nút "Reserve"
  ![image](https://github.com/Manh130902/wordpress/assets/93723285/a68cf53e-2838-47c7-a912-7b5d226816bf)

- B4: Khi bạn đã được chuyển hướng đến trang "Your reservation has been submited", hãy thêm payload ENCODED %3Cscript%3Ealert%281%29%3C%2Fscript%3E vào tham số message trong URL;
  ![image](https://github.com/Manh130902/wordpress/assets/93723285/2cc01c23-b3df-4490-b1b1-8efe7860e499)

- Kết quả
  ![image](https://github.com/Manh130902/wordpress/assets/93723285/36c69d76-0656-4bd9-ab9e-d93471a9b068)
