# CVE-2021-24183

- Plugin : AdRotate Banner Manager
- Phiên bản lỗi : 5.8.3.1
- Lỗi : Authenticated Blind SQL Injection
- CVSS Score: 5.5 (MEDIUM)

# Mô tả

- AdRotate Banner Manager là 1 trình quản lý các quảng cáo. Nhưng do dữ liệu nhập không được xác thực trong plugin AdRotate WordPress, các phiên bản trước 5.8.4, sẽ dẫn đến việc chèn SQL được xác thực thông qua thông số "id". Điều này yêu cầu người dùng có đặc quyền của quản trị viên

# POC

- Thông số "id" dễ bị tấn công bởi SQL Injeciton.
  Ví dụ 1: wp-admin/admin.php?page=adrotate-statistics&view=group&id=1+AND+SLEEP%2810%29
  Phiên bản rõ ràng: wp-admin/admin.php?page=adrotate-statistics&view=group&id=1 VÀ SLEEP(5)
- Truy vấn này sẽ trì hoãn tải trang 5 giây

# Khai Thác

- Bắt request kiểm tra xem thời gian phản hồi của trang có chậm không??

- Ta để ý thời gian trả về lớn hơn 5 giây
- Sử dụng công cụ Sqlmap để thực hiện tấn công
  B1: Xác định lỗi là time-based blind sqli

B2: Dump bảng trong information_schema

B3: Dump cột trong bảng wp_users

B4: Dump giá trị của các cột trong bảng wp_users

# Sửa Lỗi

- phiên bản vá lỗi: 5.8.4
