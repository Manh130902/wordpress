CVE-2020-7048
- Plugin: Database Reset
- Lỗi : Unauthenticated Database Reset
- Phiên bản lỗi : 3.1 

a) Mô tả
- Plugin Database Reset WordPress cho phép bạn đặt lại cơ sở dữ liệu (tất cả các bảng hoặc bảng bạn chọn) về cài đặt mặc định mà không cần phải cài đặt WordPress hoặc phải sửa đổi bất kỳ tệp nào.
- Plugin không xác thực xem người dùng nào đang sử dụng quyền xóa hoặc thay đổi DB điều này dẫn đến ngay cả những người có quyền thấp nhất cũng có thể xóa hoặc chỉnh sửa DB. Nghiêm trọng hơn là kẻ tấn công có thể xóa quản trị viên và đưa mình lên làm quản trị viên

b) Hàm xử lý bị lỗi
- Ta so sánh hàm xử lý reset trước và sau khi chỉnh sửa lỗi
+ Trước :
![image](https://github.com/Manh130902/wordpress/assets/93723285/6a585bb5-d9c8-47a2-87ec-2cc0edb1623f)
 
+ Sau :
![image](https://github.com/Manh130902/wordpress/assets/93723285/50d1477d-b6ec-4622-9813-568d85e147c3)
 
- Ta có thể dễ dàng thấy được trước khi sửa lỗi thì hàm reset không check xem là người đang chỉnh sửa có phải là administrator không nên 1 người dùng bình thường cũng có thể thực hiện chỉnh sửa DB 1 cách dễ dàng
  
- Để nâng cao hơn nữa lỗ hổng trước đó, bất kỳ người dùng nào được xác thực là người đăng ký trở lên đều có khả năng đặt lại bảng “wp_users”. Bất cứ khi nào bảng “wp_users” được đặt lại, nó sẽ loại bỏ tất cả người dùng khỏi bảng người dùng, bao gồm cả quản trị viên, ngoại trừ người dùng hiện đang đăng nhập. Người dùng gửi yêu cầu sẽ tự động được chuyển lên quản trị viên, ngay cả khi họ chỉ là người đăng ký. Người dùng đó cũng sẽ trở thành quản trị viên duy nhất, do đó cho phép kẻ tấn công chiếm toàn bộ trang web WordPress.

![image](https://github.com/Manh130902/wordpress/assets/93723285/0796279f-ff07-4710-94c1-5827ca80df8f)
 

c) Khai thác
- POC
![image](https://github.com/Manh130902/wordpress/assets/93723285/eb8e6ff7-40eb-4e88-b2b5-6089394079bb)
 
- Chạy POC:
![image](https://github.com/Manh130902/wordpress/assets/93723285/0e28892c-44da-49a9-9f84-8a234b22e584)
 
- Hiện tại thì trong bảng user đang có 2 ngưới dùng là admin và test
![image](https://github.com/Manh130902/wordpress/assets/93723285/21f4415c-b17f-47f8-aed4-50232c4d01fc)

- Test là 1 người dùng bình thường. ta đăng nhập vào người dùng test sử dụng payload vừa tạo ở trên để xem kết quả
![image](https://github.com/Manh130902/wordpress/assets/93723285/93421c7d-93c2-4907-9650-14c62c4b6cf0)
 
- Kết quả :
![image](https://github.com/Manh130902/wordpress/assets/93723285/fbee2ca1-55c8-45df-af0a-a106ea98ca9e)
 
- Bảng user đã reset người dùng admin đã bị xóa và người dùng test từ một user bình thường đã tở thành Administrator
- Ngoài ra ta cũng có thể reset rất nhiều các bảng khác như ("usermeta", "posts", "comments", "links", "options", "postmeta", "terms", "term_taxonomy", "term_relationships", "termmeta", "commentmeta") nhưng nguy hiểm nhất vẫn là bảng user vì có thể xóa và thay thế được quản trị viên của page
