# CVE-2021-33851

- Plugin : Customize Login Image
- Phiên bản lỗi : < 3.5.3
- Lỗi : Admin+ Stored Cross-Site Scripting Description
- CVSS Score: 5.4 (MEDIUM)

# Mô tả

- Plugin này cho phép bạn tùy chỉnh hình ảnh và giao diện của Màn hình đăng nhập WordPress. Bạn có thể thay đổi: Logo, link của logo và màu nền.
- Plugin không loại bỏ và thoát khỏi cài đặt Liên kết Logo tùy chỉnh, điều này có thể cho phép người dùng có đặc quyền cao như admin thực hiện các cuộc tấn công Cross-Site Scripting
![image](https://github.com/Manh130902/wordpress/assets/93723285/c55c92f1-94d9-4b52-a932-312d73e47d87)

# POC

- Chuyển đến menu “Setting” và nhấp vào danh sách thả xuống “Customize Login Image”.
- Nhập tải trọng – `<script>alert(document.cookie)</script>` vào trường ‘Custom Logo Link’ (tham số cli_logo_url).
- Nhấn nút ‘Save Changes’ để lưu lại cài đặt
- Sau khi lưu xong thì chỉ cần truy cập vào trang đăng nhập thì đoạn script sẽ được thưc thi

# Khai thác

- Chuyển đến menu “Setting” và nhấp vào danh sách thả xuống “Customize Login Image”.
![image](https://github.com/Manh130902/wordpress/assets/93723285/cc9d87b1-a7aa-49ed-905f-bc8818e213d0)

- Nhập tải trọng `<script>alert(document.cookie)</script>` vào trường ‘Custom Logo Link’ (tham số cli_logo_url).
- Nhấn nút ‘Save Changes’ để lưu lại cài đặt
![image](https://github.com/Manh130902/wordpress/assets/93723285/50224c9f-c9d7-41fd-8bd5-012435029885)

- Sau khi lưu xong thì chỉ cần truy cập vào trang đăng nhập thì đoạn script sẽ được thưc thi
![image](https://github.com/Manh130902/wordpress/assets/93723285/9f78f2f2-04f5-40d1-8e84-063ae9d2a0e4)
